{% extends 'base.html' %}
{% load filtros %}

{% block header %}

  <div class="header-gradient">
    <div class="row justify-content-center align-items-center">
      <div class="col-10">
        <h4 class="text-light ml-4">
          {{ trabalhador.nome }}
          {% if trabalhador.situacao == 'abono' %}
            - abonando hoje
          {% elif trabalhador.situacao == 'ferias' %}
            - de férias
          {% elif trabalhador.situacao == 'licenca' %}
            - de licença-prêmio
          {% endif %}
        </h4>
      </div>
      <div class="col-2">
        <form method="POST" action="{% url 'pdf' %}" class="mr-1" {% if not ferias_fruidas and not ferias_futuras and not ferias_indeferidas and not abonos_fruidos and not abonos_futuros and not abonos_indeferidos and not licencas_fruidas and not licencas_futuras and not licencas_indeferidas %}disabled{% endif %}>
          {% csrf_token %}
          <input type='hidden' name='tipo' value="trabalhador_historico" />
          <input type='hidden' name='trabalhador_id' value="{{ trabalhador.id }}" />
          <button style='color: #4a4;' type='submit' class="btn btn-sm btn-block btn-info" data-toggle="tooltip" data-placement="top" title="Gerar PDF" {% if not ferias_fruidas and not ferias_futuras and not ferias_indeferidas and not abonos_fruidos and not abonos_futuros and not abonos_indeferidos and not licencas_fruidas and not licencas_futuras and not licencas_indeferidas %}disabled{% endif %}>
            <i class="far fa-file-pdf text-light"></i>
          </button>
        </form>
      </div>
    </div>
  </div>

{% endblock %}

{% block conteudo %}

  {% if ferias_futuras or ferias_fruidas or ferias_indeferidas %}
    <div class="col-12 my-2">
      <div class="card">
        <div class="card-header">
          <h5 class='card-title text-center'>Férias</h5>
        </div>
        <div class="card-body">
          {% if ferias_futuras %}
            <h3 class="text-center text-primary">futuras</h3>
            {% with ferias=ferias_futuras tipo='ferias' %}
              <div class="my-2">
                {% include 'tables/ferias.html' %}
              </div>
            {% endwith %}
          {% endif %}
          {% with arquivada=True %}
            {% if ferias_fruidas %}
              {% with ferias=ferias_fruidas %}
                <h3 class="text-center text-primary">fruídas</h3>
                <div class="my-2">
                  {% include 'tables/ferias.html' %}
                </div>
              {% endwith %}
              {% endif %}
            {% if ferias_indeferidas %}
              {% with ferias=ferias_indeferidas %}
                <h3 class="text-center text-primary">indeferidas</h3>
                <div class="my-2">
                  {% include 'tables/ferias.html' %}
                </div>
              {% endwith %}
            {% endif %}
          {% endwith %}
        </div>
      </div>
    </div>
  {% endif %}

  {% if licencas_futuras or licencas_fruidas or licencas_indeferidas %}
    <div class="col-12 my-2">
      <div class="card">
        <div class="card-header">
          <h5 class='card-title text-center'>Licenças-prêmio</h5>
        </div>
        <div class="card-body">
          {% if licencas_futuras %}
            <h3 class="text-center text-primary">futuras</h3>
            {% with licencas=licencas_futuras tipo='licenca' %}
              <div class="my-2">
                {% include 'tables/licenca.html' %}
              </div>
            {% endwith %}
          {% endif %}
          {% with arquivada=True %}
            {% if licencas_fruidas %}
              {% with licencas=licencas_fruidas %}
                <h3 class="text-center text-primary">fruídas</h3>
                <div class="my-2">
                  {% include 'tables/licenca.html' %}
                </div>
              {% endwith %}
            {% endif %}
            {% if licencas_indeferidas %}
              {% with licencas=licencas_indeferidas %}
                <h3 class="text-center text-primary">indeferidas</h3>
                <div class="my-2">
                  {% include 'tables/licenca.html' %}
                </div>
              {% endwith %}
            {% endif %}
          {% endwith %}
        </div>
      </div>
    </div>
  {% endif %}

  {% if abonos_futuros or abonos_fruidos or abonos_indeferidos %}
    <div class="col-12 my-2">
      <div class="card">
        <div class="card-header">
          <h5 class='card-title text-center'>Abonos</h5>
        </div>
        <div class="card-body">
          {% if abonos_futuros %}
            <h3 class="text-center text-primary">futuros</h3>
            {% with abonos=abonos_futuros tipo='abono' %}
              <div class="my-2">
                {% include 'tables/abono.html' %}
              </div>
            {% endwith %}
          {% endif %}
          {% with arquivado=True %}
            {% if abonos_fruidos %}
              {% with abonos=abonos_fruidos %}
                <h3 class="text-center text-primary">fruídos</h3>
                <div class="my-2">
                  {% include 'tables/abono.html' %}
                </div>
              {% endwith %}
            {% endif %}
            {% if abonos_indeferidos %}
              {% with abonos=abonos_indeferidos %}
                <h3 class="text-center text-primary">indeferidos</h3>
                <div class="my-2">
                  {% include 'tables/abono.html' %}
                </div>
              {% endwith %}
            {% endif %}
          {% endwith %}
        </div>
      </div>
    </div>
  {% endif %}

{% endblock %}
